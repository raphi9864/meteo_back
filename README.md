# TodoApi - API de Gestion de T√¢ches

Une API REST compl√®te d√©velopp√©e en ASP.NET Core 9.0 avec authentification JWT et base de donn√©es Oracle.

## üöÄ Fonctionnalit√©s

- **Authentification JWT compl√®te** (inscription, connexion, tokens s√©curis√©s)
- **CRUD complet pour les t√¢ches** (cr√©er, lire, modifier, supprimer)
- **Gestion des profils utilisateurs**
- **Base de donn√©es Oracle** avec Entity Framework Core
- **S√©curit√© par utilisateur** (isolation des donn√©es)
- **Gestion globale des erreurs** avec middleware personnalis√©
- **Documentation Swagger/OpenAPI**

## üõ†Ô∏è Technologies Utilis√©es

- **ASP.NET Core 9.0**
- **Entity Framework Core** avec Oracle
- **JWT Bearer Authentication**
- **BCrypt** pour le hachage des mots de passe
- **Swagger/OpenAPI** pour la documentation
- **Oracle Database** (compatible avec Oracle Cloud)

## üìã Pr√©requis

- .NET 9.0 SDK
- Oracle Database (local ou Oracle Cloud)
- Visual Studio 2022 ou VS Code

## ‚öôÔ∏è Installation

1. **Cloner le repository**
   ```bash
   git clone https://github.com/raphi9864/meteo_back.git
   cd meteo_back
   ```

2. **Restaurer les packages NuGet**
   ```bash
   dotnet restore
   ```

3. **Configurer la base de donn√©es**
   - Modifier `appsettings.Development.json` avec votre cha√Æne de connexion Oracle
   ```json
   {
     "ConnectionStrings": {
       "DefaultConnection": "Data Source=localhost:1521/todo;User Id=votre_user;Password=votre_password;"
     }
   }
   ```

4. **Cr√©er les tables Oracle**
   ```sql
   CREATE TABLE USERS (
       ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
       EMAIL VARCHAR2(255) NOT NULL UNIQUE,
       PASSWORDHASH VARCHAR2(500) NOT NULL,
       FIRSTNAME VARCHAR2(100),
       LASTNAME VARCHAR2(100),
       CREATEDAT TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
       ISACTIVE NUMBER(1) DEFAULT 1
   );

   CREATE TABLE TODOITEMS (
       ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
       TITLE VARCHAR2(500) NOT NULL,
       ISDONE NUMBER(1) DEFAULT 0,
       USERID NUMBER NOT NULL,
       CONSTRAINT FK_TODOITEMS_USERS FOREIGN KEY (USERID) REFERENCES USERS(ID)
   );

   CREATE TABLE USERPROFILES (
       ID NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
       FIRSTNAME VARCHAR2(100),
       LASTNAME VARCHAR2(100),
       EMAIL VARCHAR2(255) UNIQUE,
       BIRTHDATE DATE
   );
   ```

5. **Lancer l'application**
   ```bash
   dotnet run
   ```

L'API sera disponible sur `https://localhost:7149` (HTTPS) et `http://localhost:5149` (HTTP).

## üìñ Documentation API

Une fois l'application lanc√©e, acc√©dez √† la documentation Swagger :
- **Interface Swagger UI** : `https://localhost:7149/swagger`

## üîê Authentification

### Inscription
```http
POST /api/auth/register
Content-Type: application/json

{
  "email": "utilisateur@example.com",
  "password": "MotDePasse123!",
  "firstName": "Pr√©nom",
  "lastName": "Nom"
}
```

### Connexion
```http
POST /api/auth/login
Content-Type: application/json

{
  "email": "utilisateur@example.com",
  "password": "MotDePasse123!"
}
```

### Utilisation du token
```http
Authorization: Bearer votre_jwt_token_ici
```

## üìù Endpoints Principaux

### Authentification
- `POST /api/auth/register` - Inscription
- `POST /api/auth/login` - Connexion

### T√¢ches (authentification requise)
- `GET /api/todo` - Lister les t√¢ches
- `POST /api/todo` - Cr√©er une t√¢che
- `PUT /api/todo/{id}` - Modifier une t√¢che
- `DELETE /api/todo/{id}` - Supprimer une t√¢che

### Profils Utilisateur (authentification requise)
- `GET /api/userprofiles` - Lister les profils
- `POST /api/userprofiles` - Cr√©er un profil
- `PUT /api/userprofiles/{id}` - Modifier un profil
- `DELETE /api/userprofiles/{id}` - Supprimer un profil

## üöÄ D√©ploiement

Consultez le fichier `render-deploy.md` pour les instructions de d√©ploiement sur Render avec Oracle Cloud.

## üìÅ Structure du Projet

```
TodoApi/
‚îú‚îÄ‚îÄ Controllers/          # Contr√¥leurs API
‚îú‚îÄ‚îÄ Data/                # Contexte Entity Framework
‚îú‚îÄ‚îÄ Middleware/          # Middlewares personnalis√©s
‚îú‚îÄ‚îÄ Models/              # Mod√®les de donn√©es
‚îú‚îÄ‚îÄ Services/            # Services (JWT, etc.)
‚îú‚îÄ‚îÄ Properties/          # Configuration de lancement
‚îú‚îÄ‚îÄ appsettings.json     # Configuration production
‚îî‚îÄ‚îÄ Program.cs           # Point d'entr√©e
```

## üîß Configuration

### Variables d'environnement pour la production
- `ConnectionStrings__DefaultConnection` - Cha√Æne de connexion Oracle
- `Jwt__Key` - Cl√© secr√®te JWT
- `Jwt__Issuer` - √âmetteur JWT
- `Jwt__Audience` - Audience JWT

## üêõ D√©pannage

### Probl√®mes courants Oracle
1. **Erreur "FALSE identificateur non valide"** : V√©rifiez la configuration des bool√©ens dans `TodoContext.cs`
2. **Table ou vue inexistante** : Assurez-vous que les tables sont cr√©√©es avec les bons noms (USERS, TODOITEMS, USERPROFILES)
3. **Privil√®ges insuffisants** : Accordez les privil√®ges `CONNECT`, `RESOURCE`, et `CREATE TABLE` √† votre utilisateur

## üìÑ Licence

Ce projet est sous licence MIT.

## üë• Contributeurs

- [raphi9864](https://github.com/raphi9864) - D√©veloppeur principal

## üìû Support

Pour toute question ou probl√®me, veuillez ouvrir une issue sur ce repository. 